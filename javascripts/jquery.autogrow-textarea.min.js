(function(e){e.fn.autogrow=function(){return this.filter("textarea").each(function(){var t=this,n=e(t),r=n.height(),i=n.hasClass("autogrow-short")?0:parseInt(n.css("lineHeight"),10)||0,s=e("<div />").css({position:"absolute",top:-1e4,left:-1e4,width:n.width(),fontSize:n.css("fontSize"),fontFamily:n.css("fontFamily"),fontWeight:n.css("fontWeight"),lineHeight:n.css("lineHeight"),resize:"none","word-wrap":"break-word"}).appendTo(document.body),o=function(e){var o=t.value.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/&/g,"&amp;").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br/>").replace(/ {2,}/g,function(e){return(new Array(e.length)).join("&nbsp;")+" "});e&&e.data&&e.data.event==="keydown"&&e.keyCode===13&&(o+="<br />");s.css("width",n.width());s.html(o+(i===0?"...":""));n.height(Math.max(s.height()+i,r))};n.change(o).keyup(o).keydown({event:"keydown"},o).bind("input paste",o);e(window).resize(o);o()})}})(jQuery);